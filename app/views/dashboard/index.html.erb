<% unless current_meeting.nil? %>
  <ul class="switch middle">
    <li><a href="#pick" class="selected">Today</a></li>
    <li><a href="#selections" class="fetch" data-url="/dashboard/fetch_selections">My Picks</a></li>
    <li><a href="#league" class="fetch" data-url="/dashboard/fetch_league">League</a></li>
    <li><a href="#join" class="fetch" data-url="/dashboard/fetch_league">Join</a></li>
  </ul>
<% end %>

<div class="well">
  <% if current_user && !current_league.empty? %>
    <div class="page-heading">
      <h2>
        <%= current_league.first.name %>
        <small><%= Meeting.find(current_league.first.meeting).racecourse %> - <%= Meeting.find(current_league.first.meeting).created_at.strftime("%d/%m/%Y") %></small>
      </h2>
    </div>

    <!-- <div class="tile-container">
      <div class="tile">
        <div class="inner">
          <i class="fa fa-eercast" aria-hidden="true"></i>
          <h3>Course</h3>
          <p><%= Meeting.find(current_league.first.meeting).racecourse %></p>
        </div>
      </div>

      <div class="tile">
        <div class="inner">
          <i class="fa fa-eercast" aria-hidden="true"></i>
          <h3>League</h3>
          <p><%= current_league.first.name %></p>
        </div>
      </div>
    </div> -->
  <% end %>

  <% if current_meeting.nil? %>
    
  <% else %>

    <% unless current_meeting.nil? %>

      <!-- Picks -->
      <div class="tab active" id="pick">
        <div id="picks">
          <%= render 'pick' %>
        </div>
      </div>

      <!-- Selections -->
      <div class="tab" id="selections">
        <%= render 'selections' %>
      </div>

      <!-- League table -->
      <div class="tab" id="league">
        <%= render 'league_table' %>
      </div>

      <!-- Join -->
      <div class="tab" id="join">
        <%= render 'join' %>
      </div>

    <% end %>
  <% end %>
</div>

<script>
  $(document).on("submit", ".like-form", function(e) {
    e.preventDefault();
    var valuesToSubmit = $(this).serialize();
    $.ajax({
      type: "POST",
      url: $(this).attr('action'),
      data: valuesToSubmit,
      dataType: "script"
    });
  });

  $(".fetch").click(function() {
    $.ajax({
      type: "GET",
      url: $(this).data("url"),
      dataType: "script"
    });
    return false;
  });
</script>
